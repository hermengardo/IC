# Relatório (13 de Agosto de 2025)

# Objetivo
- Descrever o planejamento para a construção do modelo de regressão.

## Objetivo principal do modelo (main target)
- Seja $G$ um gene composto por $k$ nucleotídeos:

$$
N = \\{ n_1, n_2, \ldots, n_k \\}.
$$

- Seja $\mathbb{V}(N) \in \mathbb{R}^d$ a representação vetorial de $N$, obtida por um modelo de linguagem para proteínas (pLM).

- Seja o conjunto de códons de $G$ definido como:

$$
C = \\{ (n_1, n_2, n_3), (n_4, n_5, n_6), \ldots, (n_{k-2}, n_{k-1}, n_k) \\}.
$$

- Seja $O$ um conjunto de genes ortólogos a $G$.

- Seja $\mathbb{B}$ uma função que estima a probabilidade de a taxa de substituições não sinônimas ($\beta$) exceder a taxa de substituições sinônimas ($\alpha$), dado um códon $c_i \in C$ e genes ortólogos $O$ ($\varepsilon_i$ é o erro da estimativa):

$$
\mathbb{B}(c_i \mid (G, O)) = P(\alpha_i < \beta_i) = P\left[ \left(\frac{dN}{dS}\right)_{c_i} < 1 \\,\middle| (G, O) \right] + \varepsilon_i,
$$

- O objetivo do modelo é encontrar uma função $f: \mathbb{R}^d \to \mathbb{R}^m$ que, dada a representação vetorial $\mathbb{V}(N)$ e o gene $G$, produza as estimativas de $\mathbb{B}(c_i \mid G, O)$ para todos os $m$ códons de $G$:

$$
f(\mathbb{V}(N),\\; G) = \left[ P(\alpha_1 < \beta_1) + \varepsilon_1, \\, \ldots, \\, P(\alpha_m < \beta_m) + \varepsilon_m \right].
$$

- Adicionalmente, busca-se a função $f$ que minimize a soma total dos erros $\varepsilon_i$:

$$
\min_{f} \\; L\left[f(\mathbb{V}(N), G)\right] = \min_{f} \sum_{i=1}^m \varepsilon_i.
$$

## Função $\mathbb{B}$
- No conjunto de dados, as estimativas da função $\mathbb{B}$ foram calculadas computacionalmente utilizando uma aproximação bayesiana da taxa de seleção diversificadora (implementado por `hyphy fubar`) a partir de genes ortólogos de invertebrados.

```shell
    hyphy fubar --code Universal \
            --alignment "./nt_tree_filtered/${prefix}.nt.filtered.fas" \
            --tree "./nwk_filtered/${prefix}.filtered.nwk" \
            --output "./output/${prefix}.filtered.fubar.json" \
            > /dev/null 2>&1
```

- Todos os valores da função $\mathbb{B}$ são acompanhados por um fator de Bayes, que determina a `significância` da estimativa. Para cada gene $G$, a média do fator de Bayes da função $\mathbb{B}$ aplicada em cada códon de G será mapeada para uma variável ordinal a fim de separar conjuntos de treino conjuntos de dados pelo grau de incerteza da estimativa original. Os benchmarks serão executados em todos os conjuntos separadamente para avaliar o efeito da inclusão de estimativas pouco confiáveis no modelo.

# Modelos

# Fine tunning

# Métricas de erro

# Validação

Colocar em algum lugar depois:
- Parte-se do pressuposto que os embeddings de proteína codificam informações evolutivas. Em função disso, o modelo com embeddings de proteínas será avaliado contra modelos de vetorização por frequência ou não contextuais.

## Referências

##
