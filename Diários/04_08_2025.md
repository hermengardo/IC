# Diário (04/08/2025)

## Hoje
- [ ] Escrever o script para a vetorização dos nucleotídeos.

### Script para alocar tempo de GPU no cluster (jupyter notebook com GPU)
```
salloc --partition=partition --nodelist=node --time=00:30:00 # 30 minutos
srun --jobid=$ID --pty bash
ssh -L PORT:localhost:PORT -J USER@HOST USER@NODE
```

### Código de exemplo do EVO2
```python
  import torch
  from evo2 import Evo2
  
  evo2_model = Evo2('evo2_7b')
  
  sequence = 'ACGT'
  input_ids = torch.tensor(
      evo2_model.tokenizer.tokenize(sequence),
      dtype=torch.int,
  ).unsqueeze(0).to('cuda:0')
  
  layer_name = 'blocks.28.mlp.l3'
  
  outputs, embeddings = evo2_model(input_ids, return_embeddings=True, layer_names=[layer_name])
  
  print('Embeddings shape: ', embeddings[layer_name].shape)
```
- Gera o erro:
```python
  RuntimeError: /TransformerEngine/transformer_engine/common/gemm/cublaslt_gemm.cu:412 in function cublas_gemm: cuBLAS Error: an unsupported value or parameter was passed to the function
``` 
## Amanhã:
- [x] Identificar e resolver os erros.
- [x] Detalhar erro e solução no diário.
- [x] Terminar de configurar o ambiente.
- [x] Resolver o erro do evo2
- [ ] Continuar a processar os dados.
